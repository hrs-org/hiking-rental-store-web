<div class="container">
  <app-pwa-header
    [title]="mode === 'edit' ? 'Edit Item' : 'Add Item'"
    [backButtonVisible]="true"
  ></app-pwa-header>
  <!-- Content -->
  <div class="content">
    <!-- Parent Item Section -->
    <section class="section">
      <div class="form-row">
        <mat-form-field>
          <mat-label>Item Name</mat-label>
          <input
            matInput
            placeholder="Item Name"
            id="parentName"
            required
            [(ngModel)]="item.name"
          />
          @if (item.name === '') {
            <mat-error>Item Name is required</mat-error>
          }
        </mat-form-field>
        <mat-form-field>
          <mat-label>Item Description</mat-label>
          <textarea
            matInput
            id="parentDescription"
            required
            [(ngModel)]="item.description"
          ></textarea>
          @if (item.description === '') {
            <mat-error>Item Description is required</mat-error>
          }
        </mat-form-field>
        <div class="stock-group">
          <mat-label class="stock-label">
            Quantity
            <input
              type="number"
              class="stock-input"
              id="parentQuantity"
              min="0"
              [(ngModel)]="item.quantity"
            />
          </mat-label>
          <mat-label class="stock-label">
            Price
            <input
              type="number"
              class="stock-input"
              id="parentPrice"
              min="0"
              [(ngModel)]="item.price"
            />
          </mat-label>
        </div>
      </div>
    </section>

    <!-- Children Section -->
    <section class="section">
      <h2 class="section-title">Children Items</h2>

      <!-- Children List -->
      <div class="children-list" id="childrenList">
        @for (childrenItem of item.children; track childrenItem.id) {
          <div class="child-row">
            <div class="input-group">
              <input
                required
                type="text"
                class="input-field"
                placeholder="Child Item Name"
                id="childName_{{ childrenItem.id }}"
                [(ngModel)]="childrenItem.name"
              />
            </div>
            <div class="stock-group">
              <div class="stock-label">Quantity</div>
              <input
                type="number"
                class="stock-input"
                id="{childrenItem.id}"
                [(ngModel)]="childrenItem.quantity"
                min="0"
              />
            </div>
            <button class="action-btn delete-btn" title="Delete Item">
              <svg
                width="18"
                height="18"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <polyline points="3,6 5,6 21,6" />
                <path
                  d="m19,6v14a2,2 0 0,1-2,2H7a2,2 0 0,1-2-2V6m3,0V4a2,2 0 0,1 2-2h4a2,2 0 0,1 2,2v2"
                />
              </svg>
            </button>
          </div>
        }
      </div>

      <!-- Add Child Button -->
      <button class="add-variant-btn" (click)="addChildItem()">
        <svg
          width="16"
          height="16"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
        >
          <line x1="12" y1="5" x2="12" y2="19" />
          <line x1="5" y1="12" x2="19" y2="12" />
        </svg>
        Add Variant
      </button>
    </section>
  </div>

  <!-- Save Button -->
  <button class="save-btn" (click)="onSubmit()">Save</button>
</div>
