<div class="register-container">
  <h1 class="register-title">Register</h1>

  <form [formGroup]="registerForm" (ngSubmit)="onSubmit()">
    <div class="form-group">
      <mat-label class="form-label">
        First Name
        <span class="asterisk">*</span>
      </mat-label>
      <input
        class="form-input"
        [class.error]="hasError('firstName')"
        formControlName="firstName"
        required
        placeholder="Enter your first name"
      />
      <div *ngIf="hasError('firstName')" class="error-message">
        {{ getErrorMessage('firstName') }}
      </div>
    </div>

    <div class="form-group">
      <mat-label class="form-label">
        Last Name
        <span class="asterisk">*</span>
      </mat-label>
      <input
        class="form-input"
        [class.error]="hasError('lastName')"
        formControlName="lastName"
        required
        placeholder="Enter your last name"
      />
      <div *ngIf="hasError('lastName')" class="error-message">
        {{ getErrorMessage('lastName') }}
      </div>
    </div>

    <div class="form-group">
      <mat-label class="form-label">
        Email
        <span class="asterisk">*</span>
      </mat-label>
      <input
        class="form-input"
        [class.error]="hasError('email')"
        formControlName="email"
        type="email"
        required
        placeholder="Enter your email"
      />
      <div *ngIf="hasError('email')" class="error-message">
        {{ getErrorMessage('email') }}
      </div>
    </div>

    <div class="form-group">
      <mat-label class="form-label">
        Password
        <span class="asterisk">*</span>
      </mat-label>
      <div class="password-input-container">
        <input
          class="form-input password-input"
          [class.error]="hasError('password')"
          [type]="hidePassword ? 'password' : 'text'"
          formControlName="password"
          required
          placeholder="Minimum 8 characters"
        />
        <button
          type="button"
          class="password-toggle-btn"
          (click)="togglePasswordVisibility()"
          [attr.aria-label]="hidePassword ? 'Show password' : 'Hide password'"
        >
          <mat-icon>
            {{ hidePassword ? 'visibility_off' : 'visibility' }}
          </mat-icon>
        </button>
      </div>
      <div *ngIf="hasError('password')" class="error-message">
        {{ getErrorMessage('password') }}
      </div>
    </div>

    <div class="form-group">
      <mat-label class="form-label">
        Confirm Password
        <span class="asterisk">*</span>
      </mat-label>
      <div class="password-input-container">
        <input
          class="form-input password-input"
          [class.error]="hasError('confirmPassword') || getPasswordMatchError()"
          [type]="hideConfirmPassword ? 'password' : 'text'"
          formControlName="confirmPassword"
          required
          placeholder="Confirm your password"
        />
        <button
          type="button"
          class="password-toggle-btn"
          (click)="toggleConfirmPasswordVisibility()"
          [attr.aria-label]="hideConfirmPassword ? 'Show password' : 'Hide password'"
        >
          <mat-icon>
            {{ hideConfirmPassword ? 'visibility_off' : 'visibility' }}
          </mat-icon>
        </button>
      </div>
      <div *ngIf="hasError('confirmPassword')" class="error-message">
        {{ getErrorMessage('confirmPassword') }}
      </div>
      <div *ngIf="getPasswordMatchError()" class="error-message">
        {{ getPasswordMatchError() }}
      </div>
    </div>

    <div class="form-group">
      <mat-label class="form-label">
        Register As
        <span class="asterisk">*</span>
      </mat-label>
      <mat-form-field appearance="fill" class="full-width">
        <mat-select formControlName="role">
          <mat-option *ngFor="let r of roles" [value]="r.value">{{ r.viewValue }}</mat-option>
        </mat-select>
      </mat-form-field>
    </div>

    <div class="form-group" *ngIf="registerForm.get('role')?.value === 'Store'">
      <mat-label class="form-label">
        Store Name
        <span class="asterisk">*</span>
      </mat-label>
      <input
        class="form-input"
        [class.error]="hasError('storeName')"
        formControlName="storeName"
        placeholder="Enter your store name"
      />
      <div *ngIf="hasError('storeName')" class="error-message">
        {{ getErrorMessage('storeName') }}
      </div>
    </div>

    <div class="form-group" *ngIf="registerForm.get('role')?.value === 'Store'">
      <mat-label class="form-label">
        Store Address
        <span class="asterisk">*</span>
      </mat-label>
      <input
        class="form-input"
        [class.error]="hasError('storeAddress')"
        formControlName="storeAddress"
        placeholder="Enter store address"
      />
      <div *ngIf="hasError('storeAddress')" class="error-message">
        {{ getErrorMessage('storeAddress') }}
      </div>
    </div>

    <div class="form-group" *ngIf="registerForm.get('role')?.value === 'Store'">
      <mat-label class="form-label">Store Description</mat-label>
      <textarea
        class="form-input"
        formControlName="storeDescription"
        placeholder="Optional: describe your store"
        rows="3"
      ></textarea>
    </div>

    <div class="form-group" *ngIf="registerForm.get('role')?.value === 'Store'">
      <mat-label class="form-label">Store Phone Number</mat-label>
      <input
        class="form-input"
        [class.error]="hasError('storePhoneNumber')"
        formControlName="storePhoneNumber"
        placeholder="Enter store phone number"
      />
      <div *ngIf="hasError('storePhoneNumber')" class="error-message">
        {{ getErrorMessage('storePhoneNumber') }}
      </div>
    </div>

    <br />

    <button class="register-btn" type="submit">Register</button>
  </form>

  <a href="#" class="back-link" (click)="handleBackToLogin($event)">‚Üê Back To Login</a>
</div>
